<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">

<link rel="import" href="../../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">

<link rel="import" href="tm-dropdown-menu.html">
<link rel="import" href="tm-gridpanel.html">
<link rel="import" href="tm-app.html">
<link rel="import" href="tm-firebase.html">

<dom-module id="tm-questionnaire-app">
  <template>
    <style>
      :host {
        display: block;
      }
      .page {
        display:inline-block;
        box-sizing:border-box;
        height:100%;
        width:100%;
        padding:10px;
      }
      .item {
        display:inline-block;
        width:50%;
        margin:0;
        padding:10px;
        float:left;
        box-sizing:border-box;
      }
      tm-gridpanel {
        width:100%;
      }
    </style>

    <!-- <firebase-app
      name="questionnaire-f54f6"
      api-key="AIzaSyCFp-qmqmnzZr_XRNVW3GnkTyk18ZlwW0s"
      auth-domain="questionnaire-f54f6.firebaseapp.com"
      database-url="https://questionnaire-f54f6.firebaseio.com">
    </firebase-app>

    <firebase-auth id="auth"
      app-name="questionnaire-f54f6"
      user="{{user}}"
      signed-in="{{signedIn}}"
      provider="google"></firebase-auth> -->



    <tm-app app-title="Questionnaire" titles="Authorisation,Select,Edit,Run" selected="0">
      <div class="page">
        <tm-firebase
          app-name="questionnaire-f54f6"
          app-key="AIzaSyCFp-qmqmnzZr_XRNVW3GnkTyk18ZlwW0s"
          auth-domain="questionnaire-f54f6.firebaseapp.com"
          database-url="https://questionnaire-f54f6.firebaseio.com"
          provider="google">

          <firebase-query id="questionnaireList"
            app-name="questionnaire-f54f6"
            path="/questionnaire"
            data="{{questionnaires}}">
          </firebase-query>

          <firebase-document id="questionnaireObject"
            app-name="questionnaire-f54f6"
            path="/questionnaire/[[questionnaireKey]]"
            data="{{questionnaire}}">
          </firebase-document>

          <firebase-query id="instanceList"
            app-name="questionnaire-f54f6"
            path="/instance/[[questionnaireKey]]"
            data="{{instances}}">
          </firebase-query>

          <firebase-query id="pageList"
            app-name="questionnaire-f54f6"
            path="/page/[[questionnaireKey]]"
            data="{{pages}}">
          </firebase-query>

        </tm-firebase>
        <!-- <tm-gridpanel>
          <h2 class="triple" style="text-align:center;margin:0">Hello [[_getFirstName(user)]]</h2>
          <paper-input class="double" label="Name" disabled value="{{user.displayName}}"></paper-input>
          <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
          <paper-input class="double" label="Signed In" disabled value="{{signedIn}}"></paper-input>
          <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
          <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
          <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
          <paper-input class="triple" label="Email" disabled value="{{user.email}}"></paper-input>
        </tm-gridpanel> -->
      </div>
      <div class="page">
        <tm-gridpanel size="medium">
          <paper-input label="Questionnaire Key" value="[[questionnaireKey]]"></paper-input>
          <paper-input label="Instance Key" value="[[instanceKey]]"></paper-input>
          <paper-input label="Page Key" value="[[pageKey]]"></paper-input>
          <tm-dropdown-menu label="Questionnaire" items="{{questionnaires}}" selected="{{questionnaireKey}}" ></tm-dropdown-menu>
          <tm-dropdown-menu label="Instance" items="{{instances}}" selected="{{instanceKey}}" ></tm-dropdown-menu>
          <tm-dropdown-menu label="Page" items="{{pages}}" selected="{{pageKey}}" ></tm-dropdown-menu>
        </tm-gridpanel>
      </div>
      <div class="page">
        Page Three
      </div>
      <div class="page">
        <tm-app titles="a,b,c,d,e,f,g" selected="2"></tm-app>
      </div>
    </tm-app>

    <!-- <paper-drawer-panel id="drawer" force-narrow>
      <paper-header-panel drawer>
        <paper-toolbar>
          <div class="title">Menu</div>
        </paper-toolbar>
        <paper-menu id="menu" selected="{{selected}}">
          <template is="dom-repeat" items="{{titles}}">
              <paper-item>{{item}}</paper-item>
          </template>
        </paper-menu>
      </paper-header-panel>

      <paper-scroll-header-panel main>
        <paper-toolbar>
          <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
          <div class="flex title">Questionnaire - [[pageTitle]]</div>
          <paper-icon-button icon="search"></paper-icon-button>
          <paper-icon-button icon="more-vert"></paper-icon-button>
        </paper-toolbar>

        <iron-pages class="content" selected="{{selected}}">
          <div class="page">
            <tm-gridpanel>
              <h2 class="triple" style="text-align:center;margin:0">Hello [[_getFirstName(user)]]</h2>
              <paper-input class="double" label="Name" disabled value="{{user.displayName}}"></paper-input>
              <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
              <paper-input class="double" label="Signed In" disabled value="{{signedIn}}"></paper-input>
              <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
              <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
              <paper-input label="Signed In" disabled value="{{signedIn}}"></paper-input>
              <paper-input class="triple" label="Email" disabled value="{{user.email}}"></paper-input>
            </tm-gridpanel>
          </div>
          <div class="page">
            <div class="item"><paper-input label="Questionnaire Key" value="[[questionnaireKey]]"></paper-input></div>
            <div class="item"><paper-input label="Instance Key" value="[[instanceKey]]"></paper-input></div>
            <div class="item"><paper-input label="Page Key" value="[[pageKey]]"></paper-input></div>
            <tm-dropdown-menu label="Questionnaire" items="{{questionnaires}}" selected="{{questionnaireKey}}" ></tm-dropdown-menu>
            <tm-dropdown-menu label="Instance" items="{{instances}}" selected="{{instanceKey}}" ></tm-dropdown-menu>
            <tm-dropdown-menu label="Page" items="{{pages}}" selected="{{pageKey}}" ></tm-dropdown-menu>
          </div>
          <div class="page">
            <tm-questionnaire-inst questionnaire="{{questionnaire}}"></tm-questionnaire-inst>
          </div>
          <div class="page">
            <tm-app titles="a,b,c,d,e,f,g" selected="2"></tm-app>
          </div>
        </iron-pages>
      </paper-scroll-header-panel>

    </paper-drawer-panel> -->

  </template>

  <script>
    (function(Polymer) {
      Polymer({
        is: 'tm-questionnaire-app',
        properties: {
          // titles: {
          //   type: Array,
          //   value: ['Sign In','Select','Edit','Run'],
          //   notify: true
          // },
          questionnaires: {
            type:Array,
            notify:true
          },
          questionnaireKey: {
            type:String,
            notify:true
          },
          questionnaire: {
            type:Object,
            value: {
              title: 'a questionnaire'
            }
          },
          instances: {
            type:Array,
            notify:true
          },
          instanceKey: {
            type:String,
            notify:true
          },
          instance: {
            type:Object,
            value: {
              title: 'an instance'
            }
          },
          pages: {
            type:Array,
            notify:true
          },
          pageKey: {
            type:String,
            notify:true
          },
          page: {
            type:Object,
            value: {
              title: 'a page'
            }
          },
          // signedIn : {
          //   type: Boolean,
          //   notify:true,
          //   value: false
          // },
          // user : {
          //   type:Object,
          //   notify:true
          // },
          // selected: {
          //   type: Number,
          //   value: 0,
          //   notify: true
          // },
          // pageTitle: {
          //   type: String,
          //   notify:true,
          //   computed: '_getPageTitle(selected)'
          // }
        },
        observers: [
          'debug(questionnaires)'
        ],
        // listeners: {
        //   'menu.iron-select': 'menuSelected'
        // },
        // _getPageTitle: function(newPage) {
        //   return this.titles[newPage];
        // },
        debug: function(object) {
          console.log({m:'questionnaires', o:object});
        },
        // _getFirstName: function(user) {
        //   return (user === null ? "" : user.displayName.split(' ')[0]);
        // },
        // menuSelected: function() {
        //   console.log('sadfsadfsdaf');
        //   this.$.drawer.closeDrawer();
        // },
        ready: function() {
          //this.$.auth.signInWithEmailAndPassword('tim@mcmaster.id.au', 'asdfgh');
          //this.$.auth.signInWithPopup();
        }
      });
    })(window.Polymer);
  </script>
</dom-module>
